# Introduction

理解计算机图形的基本概念

# 问题
## 浏览器如何调用显卡功能，运行 AI 和网页渲染？



## 渲染图形的基本构建块为啥是三角形？

原因主要包括以下几点：

1. **几何稳定性**：
   - 三角形是最基本的多边形，任何多边形都可以通过分割成三角形来表示。
   - 三角形在二维和三维空间中都始终保持平面性，不会因顶点位置的改变而变形。这种性质使三角形在计算机图形学中非常稳定。

2. **计算简单**：
   - 渲染三角形涉及的计算较为简单，易于进行光栅化、投影和纹理映射。
   - 光照计算（如Phong着色模型）和其他着色算法也能高效地应用在三角形上。

3. **硬件优化**：
   - 现代图形处理单元（GPU）和渲染管线对三角形进行了专门优化。三角形光栅化是GPU的基本操作，硬件加速可以显著提高渲染速度和效率。
   - 三角形可以方便地利用顶点着色器和片元着色器来进行并行处理。

4. **顶点和边缘管理**：
   - 三角形只有三个顶点和三条边，管理起来相对简单，便于进行顶点处理、边缘检测和背面剔除。
   - 在进行复杂形状的模型化时，使用三角形可以减少算法复杂度。

5. **数据表示**：
   - 使用三角形网格（triangular mesh）可以有效地表示和处理复杂的几何形状。任意复杂的表面都可以通过三角形网格近似表示。

### 示例说明

#### 几何稳定性

考虑一个四边形（四个顶点）：
- 如果四个顶点不共面，四边形就会“扭曲”，不再是一个平面多边形。
- 而任何三个点都一定在一个平面上，因此三角形总是稳定的。

#### 硬件优化

现代GPU的设计就是为了高效处理大量三角形。如下简化的渲染管线展示了如何处理三角形：
1. **顶点处理**：顶点着色器处理每个顶点的变换和光照计算。
2. **图元组装**：顶点组合成三角形。
3. **光栅化**：将三角形转换成片元（像素），进行逐片元操作（如着色、深度测试）。

#### 数据表示

一个复杂模型可以通过三角形网格表示。假设一个立方体模型：
- 每个面是一个四边形，可以分成两个三角形。
- 因此，立方体可以由12个三角形（6个面，每个面2个三角形）表示。

## 三角形易于进行光栅化、投影和纹理映射的原因？

例子说明：

### 光栅化

光栅化是将几何图形转换为屏幕上的像素。三角形在光栅化过程中表现得非常好，主要原因如下：

1. **边界确定性**：
   - 三角形只有三条边，确定其覆盖的像素范围非常简单。
   - 使用边缘函数（Edge Function），可以高效判断一个像素是否在三角形内。

2. **扫描线算法**：
   - 扫描线算法可以轻松应用于三角形。沿着y轴从顶到底逐行扫描，通过插值计算每行的起点和终点。
   - 对于每一行，简单地填充从起点到终点的像素。

#### 示例：
考虑一个简单的三角形，其顶点为(10, 10), (50, 20), (30, 60)，通过扫描线算法，我们可以轻松地计算出每一行的填充像素范围。

### 投影

投影是将三维坐标转换为二维屏幕坐标。三角形的投影计算非常简便：

1. **顶点投影**：
   - 三角形只有三个顶点，每个顶点的投影变换可以独立计算，然后再连接这些投影后的顶点即可。

2. **透视变换**：
   - 透视变换涉及到将3D坐标乘以一个投影矩阵，对于每个顶点都进行相同的操作。
   - 变换后的三角形顶点仍然保持线性关系，确保变换后的形状是正确的。

#### 示例：
假设一个三角形在3D空间中的顶点为(1, 2, 3), (4, 5, 6), (7, 8, 9)，通过投影矩阵可以计算出这三个顶点在2D平面上的投影点，然后绘制出投影后的三角形。

### 纹理映射

纹理映射是将二维图像（纹理）应用到三维模型表面。三角形的纹理映射容易处理，主要是因为其线性插值性质：

1. **线性插值**：
   - 在三角形内部，任何一点都可以通过三个顶点的线性插值计算得到。
   - 对于纹理坐标（u, v），通过顶点的纹理坐标进行插值，可以高效地计算出三角形内部任意点对应的纹理坐标。

2. **Barycentric坐标（重心坐标）**：
   - 重心坐标是一种坐标系统，其中每个点的坐标都是基于三角形顶点的加权平均。重心坐标满足以下条件：

$$
\lambda_1 + \lambda_2 + \lambda_3 = 1
$$

#### 示例：
如果P是三角形ABC的重心（即三条中位线的交点），那么P的Barycentric坐标就是(1/3, 1/3, 1/3)，因为重心到三个顶点的距离是相等的，所以权重也相等。

#### 为什么使用 Barycentric坐标 会让纹理计算得到的效果更加细致跟真实？
因为 Barycentric 坐标提供了对三角形内部位置的精确描述，从而实现了更准确的纹理坐标插值和采样：

1. 精确的位置描述：Barycentric 坐标通过权重值准确地描述了点在三角形内的位置关系。它不仅考虑了点与三个顶点之间的距离，还考虑了点与三角形内的边界之间的关系。这种精确的位置描述使得纹理计算可以更准确地确定每个点对应的纹理坐标。

2. 光滑的插值：Barycentric 坐标可以在三角形内进行线性插值，这意味着纹理坐标可以根据点在三角形内的位置平滑地过渡。相邻点之间的纹理坐标也会进行平滑的插值，从而在渲染时产生连续、无缝的纹理效果。

3. 保持纹理特征：Barycentric 坐标的使用可以确保纹理特征在三角形内的点之间保持一致。这意味着如果一个三角形上的某个区域在纹理中具有特定的图案或纹理细节，那么通过 Barycentric 坐标计算得到的纹理坐标也会在该区域内保持相应的特征，从而保持纹理的连贯性和真实感。