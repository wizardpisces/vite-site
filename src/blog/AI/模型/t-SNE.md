# t-SNE 算法
* 一种用于数据可视化的降维技术，特别适用于高维数据的**可视化**。
* 通过将高维数据映射到二维或三维空间，t-SNE 可以展示数据的聚类结构和分布情况。通过 SNE 算法（容易拥挤）改进（联合概率分布替换条件概率分布解决分布计算对称问题，并引入 t 分布）。

## 原理
t-SNE算法的目标是将高维数据映射到低维空间（通常是二维或三维），同时尽可能保持数据点之间的相似度。为了实现这一目标，t-SNE构建了两个概率分布：一个是高维空间中的相似度分布P，另一个是低维空间中的相似度分布Q。然后，算法通过最小化这两个分布之间的Kullback-Leibler散度（KL散度）来优化低维嵌入。在低维空间中，t-SNE使用t分布来定义数据点之间的相似度，这有助于解决“拥挤问题”，使得数据点在低维空间中能够更均匀地分布。

## t-SNE 中的 't'

“t”指的是t分布（或称学生t分布、柯西分布）。t-SNE是一种专为高维数据可视化设计的降维技术，其核心原理在于，首先在高维空间中利用高斯分布来定义数据点之间的相似度，而在低维空间中则采用t分布来定义相似度。这两种分布的选择有助于算法在低维空间中保持高维空间的数据结构。

t 分布的重尾特性使得：
* 远距离点之间的排斥力增大
* 近距离点之间的吸引力减小
* 更容易形成簇
* 簇间距离更明显

### 自由度

单样本 t 检验：如果我们用一个样本估计总体均值，样本量为 n，则自由度通常是 n−1。这是因为我们计算样本的均值时用了一个数值，使得只有 n−1 个数据点可以自由变化。

* 自由度影响统计分布的形状，特别是小样本情况下。例如，在 t 分布中，自由度越小，分布的尾部越厚，因为小样本的估计不确定性更大。随着自由度增加，t 分布逐渐接近正态分布。
* 自由度还决定了假设检验的临界值和置信区间的宽度——自由度越小，检验标准会更加严格，置信区间也会变宽。

### 正态分布
* X 轴：表示随机变量的取值，反映取值的大小。
* Y 轴：表示每个取值的相对概率密度（并非直接的概率）。

## 应用

* 基因科学
    * 细胞分类：将单细胞基因表达数据降维，通过 t-SNE 在 2D 或 3D 中展示，使得具有相似基因表达模式的细胞群靠近，可以区分不同细胞类型。
    * 疾病分群：在基因组数据中，t-SNE 可帮助发现不同患者样本的模式差异，例如将癌症样本聚类在一起，展示亚型或分子特征。
    * 基因特征分析：t-SNE 可以用于探索基因间的相似性或特征模式，帮助识别在特定条件下具有相似表达的基因簇。
* computer security：t-SNE 可以用于流量日志分析
    * 异常检测：在网络流量、登录记录、或文件访问等高维数据中，t-SNE 可以将数据降维，帮助识别异常模式或异常点，从而检测可能的入侵或恶意活动。
    * 恶意软件分类：将恶意软件样本的特征（如行为特征或静态特征）降维，通过可视化识别相似的恶意软件家族，帮助分析不同种类的威胁。
    * 用户行为分析：将用户访问数据或活动日志降维，显示正常和异常行为群体，帮助识别潜在的账户接管或欺诈行为。
* 自然语言处理
    * 词嵌入可视化：通过 t-SNE 将高维词嵌入（如 Word2Vec 或 BERT 的嵌入）降维为 2D 或 3D，可以直观显示词语之间的相似性和聚类，比如“国王”与“王后”靠近，或“苹果”与“橙子”形成同一类。
    * 文档聚类：对句子或文档的嵌入进行降维，将主题相似的文档或句子分组，从而帮助发现相似的文本类别（如新闻主题或情感相似度）。
    * 情感分析：将带有情感标签的句子降维，查看正向、负向情感句子在图中的分布情况，验证模型效果。

## K-means 与 t-SNE 的区别
* K-means 是一种聚类算法，用于将数据点分组为 K 个簇，每个簇的中心是簇内数据点的平均值。
* t-SNE 是一种降维算法，用于将高维数据映射到低维空间，同时保持数据点之间的局部结构。

t-SNE 更倾向于可视化数据之间的相似性，而 K-means 更倾向于数据之间的聚类。

### 疑问
* 为什么说线性降维更好的保留了全局结构，而非线性降维更好的保留了局部结构？
>线性降维（如 PCA）保留全局结构，因为它基于数据的主成分，将整个数据集的方差最大化，以保持所有数据点的整体关系。在这种方法中，高维空间中的全局方向和差异在低维空间中得到最大保留。

> 非线性降维（如 t-SNE）更注重保留局部结构。它侧重于保持相似数据点之间的局部关系，而不在意全局距离。这样可以在低维空间中更清晰地显示数据的局部聚集模式，适合复杂、非线性分布的数据可视化。

* 形似性跟聚类的区别？
不同目标
> * t-SNE：主要用于可视化数据的相似性，通过降维将数据点的相似关系展示在二维或三维空间中。它并不定义“组”，而是让相似的数据点在空间中靠近，适合查看**数据的分布形态**。 
> * K-means：是一种聚类算法，直接将数据分成多个聚类组。它的目标是最小化组内的差异，而不是追求可视化的相似性关系。

因此，t-SNE 强调“展示相似性”，K-means 强调“形成类别”。

## t-SNE 跟 PCA 的区别
* PCA 是一种线性降维算法，通过线性变换将数据映射到低维空间，同时保留数据的主要特征。
* t-SNE 是一种非线性降维算法，通过计算数据点之间的相似度，将数据点映射到低维空间，并保持数据点之间的局部结构。
因此，t-SNE 可以更好地保留数据的局部结构，而 PCA 则更倾向于保留数据的全局结构。


### 疑问
* 线性跟非线性降维区别？

> 线性降维：假设数据在高维空间中呈现直线或平面分布，通过找到数据的主成分（如 PCA）将数据投影到更低维的空间。它适用于线性分布的数据，能够保留整体结构。
> 非线性降维：假设数据位于弯曲的流形上，数据可能具有复杂的局部结构。方法如 t-SNE 和 Isomap 会保留数据的局部相似性，适合处理复杂、非线性关系的数据，更适合可视化和聚类。

## t-SNE 与 VAE

隐空间都是基于流形空间建模

不同点
* VAE 的隐空间：通常具有一定的连续性和结构化性质。例如，VAE 的隐空间可以连续变化（KL 散度用于正则化隐空间的分布，使得隐空间的分布尽可能接近一个标准正态分布（通常是高斯分布）。正则化的目的是使隐空间连续且平滑），解码器可以将隐空间中相邻的点映射成相似的数据。对隐空间进行插值可以生成新的样本。
* t-SNE 的映射空间：因为 t-SNE 注重局部结构，其结果比较**离散**，且映射空间中的距离和高维空间中的距离不具有线性对应关系，因此无法用来生成数据。t-SNE 的低维空间只在视觉上保留局部关系，而无法生成数据或保持样本连续性。

### 流形空间
特征
* 数据的非线性结构
* 流形更适合保留局部结构

#### 应用 - 生成模型
* 隐空间的流形结构能够在生成过程中保持样本的平滑性和连贯性，从而生成自然的样本。（VAE，GAN）
* 如果隐空间是流形而不是简单的平面空间，则模型可以在隐空间中“移动”来生成具有渐变特征的样本。例如，生成不同姿态的图像或生成具有不同风格的文本。


## 参考
* 解释的很清晰 [t-SNE 算法详解](https://blog.csdn.net/qq_44015059/article/details/106675444)
* 包含 code 演示 [t-SNE 实践](https://blog.csdn.net/hustqb/article/details/80628721)
* gpt

