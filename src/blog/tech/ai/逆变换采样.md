# 逆变换采样

逆变换采样（Inverse Transform Sampling）是一种用于从任意概率分布中抽样的方法。它的基本思想是利用均匀分布的样本生成符合目标分布的样本。这个过程基于目标分布的累积分布函数（CDF，Cumulative Distribution Function）和逆累积分布函数（Inverse CDF，或Quantile Function）。

### 1. 基本步骤

**步骤1：从均匀分布中抽样**
首先，从均匀分布 \(U(0, 1)\) 中抽取样本。均匀分布意味着每个数字在0到1之间出现的概率相等。

**步骤2：计算逆变换**
使用目标分布的逆累积分布函数（Inverse CDF）将从均匀分布中抽取的样本转换为符合目标分布的样本。

### 2. 示例：从指数分布中抽样

假设我们想从指数分布中抽样。指数分布的概率密度函数（PDF）和累积分布函数（CDF）分别如下：

- 概率密度函数（PDF）：
$$f(x; \lambda) = \lambda e^{-\lambda x} $$
- 累积分布函数（CDF）：
$$F(x; \lambda) = 1 - e^{-\lambda x} $$

对于指数分布：

- **累积分布函数（CDF）** \(F(x)\) 给出了 \(X\) 小于或等于某个值的概率。
- **逆累积分布函数（Inverse CDF）** \($F^{-1}(p)$\)，其中 \($p \in [0, 1]$\)，给出了一个概率值对应的下限。

对于指数分布，其逆累积分布函数可以通过解以下方程得到：

$$p = 1 - e^{-\lambda x} $$

将这个等式解为 \(x\)：

$$x = -\frac{1}{\lambda} \ln(1 - p) $$

这里 \(p\) 是从均匀分布 \( U(0, 1) \) 中抽取的样本。

### 3. 逆变换采样的步骤

**步骤1：从均匀分布 \(U(0, 1)\) 中抽样**
假设我们抽取 \(p = 0.5\) （任何介于0和1之间的均匀随机数）。

**步骤2：计算逆变换**
针对特定的 \(\lambda\) 值（假设 \(\lambda = 1\)），我们使用逆累积分布函数 \(F^{-1}(p)\) 来转换 \(p\)：

$$x = -\frac{1}{1} \ln(1 - 0.5) = - \ln(0.5) \approx 0.693 $$

所以，使用逆变换采样，我们得到了一个符合指数分布的样本 \(x \approx 0.693\)。


## Box-Muller
Box-Muller 通过角度和半径大小两个分量的独立性分别单独生成并转换成 (x, y) 对。
无法直接通过逆变换生成一维正态分布的主要原因是正态分布的累积分布函数 (CDF) 没有解析形式，这使得逆变换方法不太实用。

[box-muller 数学推导](https://blog.csdn.net/weixin_41793877/article/details/84700875)


## 什么样的函数没有解析形式？
没有解析形式的函数是指无法通过有限个基本函数（如多项式、指数函数、对数函数、三角函数等）的代数运算和复合运算来表示其精确值的函数。换句话说，这些函数无法用一组封闭形式的表达式来表示，通常需要以数值方法、级数展开或图形来近似表示或解析。

以下是一些常见的没有解析形式的函数类型：

### 1. 特殊函数

许多特殊函数通常没有简单的解析形式。例如：
- **误差函数（Error Function, \(\operatorname{erf}(x)\)）**：这是一个出现在概率、统计和偏微分方程中的常见函数。虽然它有定义和性质，但无法用基本初等函数的有限组合表示。

  $$
  \operatorname{erf}(x) = \frac{2}{\sqrt{\pi}} \int_0^x e^{-t^2} \, dt
  $$

### 2. 隐函数

隐函数是通过多个变量间的关系定义的，并且无法显式解出。例如：
- **兰伯特 \(W\) 函数**：通过关系 \(We^W = x\) 定义。对于大多数 \(x\) 它没有闭式表达。
- **指数方程**：例如 \(x = e^{-x}\)，无法通过代数方法得到显式解。

### 3. 特定的无理或超越方程

在某些情况下，无法解析地表达某些无理或者超越方程的解。举个例子：
- **代数方程级数解**：如一般五次及更高次多项式的根，根据阿贝尔-鲁芬尼定理，无法用根式表示。

### 4. 特定积分

一些积分无法通过单一的基本函数或其简单组合进行表达。例如：
- **椭圆积分**：这些积分经常出现于物理学和工程学中，并不能通过基本函数的具体表达来表示。

$$
E(x) = \int_0^x \sqrt{1 - t^2} \, dt
$$


### 5. 特定微分方程的解

某些微分方程具有解，但这些解不能以初等函数的形式表达。例如：
- **艾里函数（Airy function, \(\operatorname{Ai}(x)\) 和 \(\operatorname{Bi}(x)\)）**：这些函数出现在量子力学和光学等领域中，经常用来描述某些物理现象。
  $$
  \frac{d^2y}{dx^2} - xy = 0 
  $$

### 总结

总体而言，当函数的定义涉及复杂的代数运算、特定的积分、微分方程的解，或者当它们的定义关系本质上是隐含的，这些函数往往没有简单的解析形式。现代数学中，尽管没有解析形式，但我们可以通过数值方法、级数展开或其他方法对它们进行近似分析和计算。这对实用计算和理论研究都是非常重要的。