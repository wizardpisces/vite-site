# 指针网络

Pointer Network（指针网络）是一种特殊类型的神经网络，它在输出中直接指向输入序列中的位置，而不是通常的固定大小的词汇表。这种结构特别适合于那些输出序列依赖于输入序列中元素位置的问题，例如排序问题。

# 例子
## 旅行推销员问题（TSP）
经典的旅行推销员问题（TSP）。在这个问题中，给定一组城市，任务是找出穿过所有城市一次、且总旅行距离最短的路线。

在传统的神经网络中，你需要预定义所有可能的路线，然后让模型选择。但这几乎是不可能的，因为可能的路线数量随城市数量的增加呈现组合爆炸。

这就是指针网络派上用场的地方。Pointer Network通过观察所有的城市（输入序列），然后输出一个序列，该序列是城市的索引，指明了应当访问城市的顺序。其关键在于网络的每一个输出元素都是根据上下文来直接指向输入序列中的某个位置。

指针网络工作的简化步骤：
1. 输入序列编码： 使用RNN/LSTM/Transformer等编码输入序列（城市的坐标）。
2. 注意力机制： 训练一个注意力模型，可对输入序列中的不同部分分配不同的权重。
3. 输出序列解码： 利用注意力权重，生成指向输入序列中元素位置的输出序列（对城市访问的顺序索引）。

通过这种方式，指针网络可以有效地处理那些其输出是输入序列的排序或重组的任务，既提高了任务的处理速度，又避免了不切实际的输出空间设计。

## 不切实际的输出

"不切实际的输出空间设计"这个短语通常指的是在某些机器学习任务中，如果我们试图预定义所有可能的输出，会遇到输出空间巨大到难以处理的问题。

### 常规神经网络和固定输出空间

许多机器学习任务，特别是在自然语言处理中，有一个固定且有限的输出空间。例如，在一个语言模型中，我们可能有一个由所有单词组成的词汇表，模型在给定上下文时预测下一个单词。这个单词列表是预定义的，尽管其可能包含成千上万的单词，它仍然是固定的。

### 指针网络和动态输出空间

与固定输出空间不同，某些任务涉及的输出空间随输入动态变化。以排序问题为例，假设我们有一个包含10个不同整数的列表，并希望网络输出它们升序排列的结果。输出的每一个位置应该是指向输入列表中某个元素的指针。如果我们尝试像处理固定词汇表一样处理这个问题，我们会遇到几个问题：

- **组合爆炸**：随着输入列表的大小增加，可能的排序结果（输出空间）是阶乘级增长的（例如，10个数有10!种排列方式），远超常规词汇表的大小。
- **输出依赖于输入**：每个不同的输入列表会有一个不同的、特定的排序结果。因此，我们无法预先定义一个能够覆盖所有可能输入的排序结果的静态词汇表。
- **效率低下**：预定义所有可能的排列会导致巨大的输出空间，使得模型不仅训练效率低，而且在执行时需要大量的计算资源。

### 解决方案

这就是为什么我们说在这种情况下进行"不切实际的输出空间设计"是不合理的。作为解决方案，指针网络提出了使用指针的概念。它不是在一个固定的词汇表中选择输出，而是生成指向输入序列中各个元素位置的索引。这种方式在处理变化的输出空间时既高效又有效。它能够根据输入动态调整其输出，从而克服了传统方法在面对这类问题时的局限性。

# Reference
* [神经网络之Pointer Net (Ptr-net)](https://zhuanlan.zhihu.com/p/30860157?from_voters_page=true)